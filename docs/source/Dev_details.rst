.. TADA documentation master file, created by
   sphinx-quickstart on Thu Jan 14 10:13:07 2021.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.



About Streamlit framework
==========================
Streamlit is an open-source app framework for Machine Learning and Data Science teams. This framework makes it easy to create and share beautiful, custom web apps for machine learning and data science, all in pure Python.

 
.. important::
   The way Streamlit works is :
   Any time something must be updated on the screen, Streamlit just **reruns the entire Python script from top to bottom**.


Installing Packages
====================
The requirement file is located at the source directory. You can install all required packages by using pip install like so:

.. code-block:: 

   python -m pip install -r requirements.txt

Launching application
======================
You can launch the app with:

.. code-block::

   streamlit run TADA_interface.py


Description of mudules
=======================

TADA interface module
-----------------------
class StInterface
~~~~~~~~~~~~~~~~~~~~~
This class displays Streamlit user Interface. 
It imports Streamlit framework. 
We also import SessionState class to keep track of the user session. 
The SessionState class allows us to store data about current state as the user navigates through web pages of this application. 
At the beginning of the script, we call SessionState.get function. 
This function create a SessionState object if necessary, or returns the previously created state object. 
Therefore, when the whole application launches the first time, since there is not an existing SessionState object, this function will create a SessionState object. 
At the end of the script, we update the fields of this SessionState object. 
Because whenever there is a user action, the script rerun from begin to end, so, at the end of the script, the new information will be stored in the SessionState object. 
Whenever the user clicks a button, SessionState.get function will return the only instance that is generated when the app launches. 
We can use this object field to track information of the previous state.

.. note::
   The prefix « St » of the class name stands for Streamlit. 

class DataStorage
~~~~~~~~~~~~~~~~~~~~~
This class stores global variables, which we don’t want lose them during every user action. Like StInterface, we create an instance of DataStorage when app launches and store it in the SessionState object at the end of the script. 


Data Grasper module
-------------------
class Datagrasper
~~~~~~~~~~~~~~~~~~~~~
This class grasp information from MIT webpage, append them into a data frame, and do the data cleaning. We change unknown data to np.nan, remove column with out name, and regularize number format, etc. Then, this data frame will be exported as a raw excel file. It reads a config file which indicates the directory path in which the generated raw excel file will be stored. 

DataTransferer module
----------------------
class DataTransferer
~~~~~~~~~~~~~~~~~~~~~
This class analyze all column names in the raw excel file and generates a standardized excel with standard columns. All standard column names and keywords are defined by the programmer and is stored in a dictionary. The key of the dictionary is the standard name, while the value is a list of strings which are the possible combinations of keywords. We create an empty data frame and by doing the regex research, we append the content of raw data frame generated by DataGrasper class object to this data frame with standard column names. Finally, the Standardized excel file will be generated to the path defined in the config file.

GraphGenerator module
----------------------
class GraphGenerator
~~~~~~~~~~~~~~~~~~~~~
This class contains functions to draw various types of graphs. In general, there are 3 types of graphs:

* The first one is pie chart, which is used to column « integrity » and « specification ». 
* The second one is bar chart, which includes single bar chart and double bar chart. We use this chart  type to draw charts which compares the result using different dummies.
* The third one is line chart. We use this chart type to compare results of different design loops.

We distinguish 3 cases:

* If user is in  **« Main Page »**, and has chosen only one design loop, then it’s in **« single loop »** mode. We draw bar charts to compare results in different load case situation.
* If user is in  **« Main Page »**, and has chosen only one design loop, then it’s in **« multiple loop »** mode. We draw line charts to compare result in different design loops.
* Otherwise (if user is in **« Compare RunID »** page), then it’s in **« compare RunIDs »** mode. We draw same type of graph as **« single loop »** mode, but instead use RunIDs as x-axis.

Matplotlib package is used to draw graphs.


Human-Computer interaction Procedure
======================================
#. StInterface displays user interface
#. User inputs all RunIDs and click **« Search »** button
#. Datagrasper grasps information from MIT website and generate a unstandardized excel
#. DataTransferer reads the unstandardized excel and transfer their column names to standardized ones, and generates a standardized excel
#. User selects graphs options and click the button **« Generate graphs »**
#. GraphGenerator reads the standardized excel and generates graphs in a PDF, finally it sends figure objects to StInterface
#. StInterface receives the graph objects and displays them on the user interface.

.. image:: pic/hci.png
   :align: center
   :alt: HCI figure
   :scale: 50



Classes and functions
======================
The principle classes are listed below:

TADA interface module
-----------------------
.. automodule:: TADA_interface
   :members:

Data Grasper module
-------------------
.. automodule:: DataGrasper
   :members:

Data Transferer module
----------------------
.. automodule:: DataTransferer
   :members:
   

Graph Generator module
----------------------
.. automodule:: GraphGenerator
   :members:




